.. title:: Точка входу "Організація" для API проекту "Суд на долоні"

.. meta::
    :desctription: Точка входу "Організація" для API проекту "Суд на долоні"
    :robots: index, follow
    :viewport: width=device-width, initial-scale=1
    :language: uk
    :keywords: Суд на долоні, API, організація
    :author: Кирило Захаров
    :copyright: Суд на долоні

Організація
===========

Точка входу "Організація" повертає інформацію про юридичні особи України.

Загальна інформація
-------------------

Інформація з Єдиного державного реєстру юридичних осіб, фізичних осіб-підприємців та громадських формувань, 
завантажена з `Національного порталу відкритих даних <https://data.gov.ua/dataset/b244f35a-e50a-4a80-b704-032c42ba8142/resource/b0476139-62f2-4ede-9d3b-884ad99afd08>`_.

Уся інформація щодо юридичних осіб оновлюється один раз на 1-2 тижні.



Кількість організацій
---------------------

GET-запит за адресою ``https://api.conp.com.ua/api/v1.0/organization`` повертає загальну кількість організацій в системі

.. sourcecode:: http

  GET /organization HTTP/1.0
  Host: https://api.conp.com.ua/api/v1.0

  { "message": 1605026 }

-----

Отримання інформації про організації
------------------------------------

GET-запит за адресою ``https://api.conp.com.ua/api/v1.0/organization/:id`` повертає інормацію про організацію за `відповідною схемою даних <organization.html>`_ `. Де ``id`` - це код ЄДРПОУ організації.

.. sourcecode:: http

  GET /organization/34975289 HTTP/1.0
  Host: https://api.conp.com.ua/api/v1.0

  {
    "legalName": "ТОВАРИСТВО З ОБМЕЖЕНОЮ ВІДПОВІДАЛЬНІСТЮ \"АНАЛІТИЧНІ ТЕХНОЛОГІЇ\"",
    "name": "ТОВ \"АНАЛІТИЧНІ ТЕХНОЛОГІЇ\"",
    "identifier": {
      "scheme": "UA-EDR",
      "id": "34975289",
      "valid": true
    },
    "currentStatus": "зареєстровано",
    "kved": {
      "part": "0",
      "group": "87"
    },
    "full_kved": "51.87.0 Оптова торгівля іншими машинами та устаткованням",
    "address": {
      "source": "69068, Запорізька обл., місто Запоріжжя, Шевченківський район, ВУЛИЦЯ 8 БЕРЕЗНЯ, будинок 32, квартира 179",
      "countryName": "Україна",
      "postalCode": "69068",
      "region": "Запорізька область",
      "district": "Шевченківський район",
      "locality": "місто Запоріжжя",
      "streetNumber": "32",
      "streetAddress": "вулиця 8 Березня, 32",
      "apartment": "179",
      "fullAddress": "69068, Запорізька область, місто Запоріжжя, вулиця 8 Березня, 32"
    },
    "head": {
      "source": "ПАЛЬЧИК ДЕНИС ВІКТОРОВИЧ",
      "idName": "Пальчик Д. В.",
      "fullName": "Пальчик Денис Вікторович",
      "familyName": "Пальчик",
      "givenName": "Денис",
      "additionalName": "Вікторович",
      "sex": "чоловік",
      "jobTitle": "Директор"
    },
    "founders": [
      {
        "source": "ПАЛЬЧИК ДЕНИС ВІКТОРОВИЧ, розмір внеску до статутного фонду - 40000.00 грн.",
        "person": {
          "source": "ПАЛЬЧИК ДЕНИС ВІКТОРОВИЧ",
          "idName": "Пальчик Д. В.",
          "fullName": "Пальчик Денис Вікторович",
          "familyName": "Пальчик",
          "givenName": "Денис",
          "additionalName": "Вікторович",
          "sex": "чоловік"
        },
        "amountOfFunds": 40000
      }
    ],
    "amountOfFunds": 40000,
    "numberOfFounders": 1,
    "updatedAt": "2018-08-06T20:54:27.833Z"
  }

-----


Пошук організацій
-----------------

POST-запит за адресою ``https://api.conp.com.ua/api/v1.0/organization/search`` дозволяє шукати організації.

POST-запит має містити JSON з наступними змінними

:query:
    рядок
    
    Перелік термінів для повнотекстового пошуку.

:defaultOperator:
    рядок
    
    Приймає значення ``or`` або ``and``, щоб шукати будь-який з термінів для повнотекстового пошуку або усі терміни.

:filter:
    об'єкт
    
    Об'єкт, який містить перелік усіх пошукових фільтрів, встановлених користувачем.

:sort:
    об'єкт
    
    Об'єкт, який визначає порядок сортування результатів.

:from:
    ціле число (integer)
    
    Кількість об'єктів, яку необхідно пропустити (використовується для пагінації).

:aggregation:
    булеве значення
    
    Якщо встановлено значення ``false``, то в результаті буде отримано перелік організацій, які відповідають повнотекстовому запиту та фільтрам. Якщо встановлено значення ``true``, то повертає перелік агрегацій для фасетного пошуку.

Фільтри
~~~~~~~

Кожен з фільтрів має бути об'єктом з певною назвою (поле, за яким відбувається фільтрація) та будуватися за схемою:

:list:
    масив рядків
    
    Перелік точних значень термінів для фільтрації результату.

:operator:
    рядок
    
    Приймає значення ``or`` або ``and``, щоб у результат попадали сутності з будь-яким зі значень фільтру або усі значення фільтру.

Організації можна фільтрувати за точними значеннями таких змінних:

* **currentStatus** - Поточний статус організації
* **fullKved** - Повний КВЕД організації
* **kved.part** - Розділ КВЕД організації
* **kved.group** - Група КВЕД організації
* **address.region** - Область організації
* **address.district** - Район або район у місті організації
* **address.locality** - Населений пункт організації
* **address.fullAddress** - Повна адреса організації
* **head.fullName** - ПІБ керівника організації
* **head.sex** - Стать керівника організації
* **founder.fullName** - ПІБ засновника організації
* **founder.sex** - Стать засновника організації
* **founder.organization** - Назва організації-засновника

Організації можна фільтрувати за діапазонами значень таких змінних (для таких фільтрів вказується діапазон зі змінними ``from`` та ``to``):

* **amountOfFunds** - Розмір статутного фонду

Приклад використання фільтру - "(1) Зареєстровані (2) в місті Одеса організації (3) зі статутним капіталом до 1000 грн., (4) які працюють у неспеціалізованій оптовій торгівлі":

.. sourcecode:: http

  ...
  {"filter": {
    "currentStatus": {
      "list": [
        "зареєстровано"
      ],
      "operator": "or"
    },
    "fullKved": {
      "list": [
        "46.90 Неспеціалізована оптова торгівля"
      ],
      "operator": "or"
    },
    "address.locality": {
      "list": [
        "місто Одеса"
      ],
      "operator": "or"
    },
    "amountOfFunds": {
      "list": [
        {
          "from": 0.001,
          "to": 1000
        }
      ]
    }
  }
  ...

Агрегація
~~~~~~~~~

Для організацій передбачено агрегацію за такими змінними:

* КВЕД
* Область організації
* Населений пункт організації
* Район або район у місті організації
* Керівник організації
* Стать керівника організації
* Статуний фонд
* Поточний статус

Агрегації розраховуються автоматично для усіх змінних, для яких встановлено фільтр. Якщо необхідно отримати агрегацію без фільтрації, то необхідно задати "пустий" фільтр таким чином:

.. sourcecode:: http

  ...
  "filter": {
    "amountOfFunds": {
      "list": [],
      "operator": "or"
    }
  }
  ...


Приклад повного запиту та відповіді
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. sourcecode:: http

  POST /organization/search HTTP/1.0
  Host: https://api.conp.com.ua/api/v1.0

  {
    "query": "",
    "defaultOperator": "or",
    "filter": {
      "identifier": {
        "list": [],
        "operator": "or"
      },
      "currentStatus": {
        "list": [],
        "operator": "or"
      },
      "fullKved": {
        "list": [],
        "operator": "or"
      },
      "kved.part": {
        "list": [],
        "operator": "or",
        "type": "object"
      },
      "kved.group": {
        "list": [],
        "operator": "or",
        "type": "object"
      },
      "address.region": {
        "list": [],
        "operator": "or"
      },
      "address.district": {
        "list": [],
        "operator": "or"
      },
      "address.locality": {
        "list": [],
        "operator": "or"
      },
      "address.fullAddress": {
        "list": [],
        "operator": "or"
      },
      "head.fullName": {
        "list": [],
        "operator": "or"
      },
      "head.familyName": {
        "list": [],
        "operator": "or"
      },
      "head.givenName": {
        "list": [],
        "operator": "or"
      },
      "head.additionalName": {
        "list": [],
        "operator": "or"
      },
      "head.sex": {
        "list": [
          "жінка"
        ],
        "operator": "or"
      },
      "founder.fullName": {
        "list": [],
        "operator": "or"
      },
      "founder.familyName": {
        "list": [],
        "operator": "and"
      },
      "founder.givenName": {
        "list": [],
        "operator": "or"
      },
      "founder.additionalName": {
        "list": [],
        "operator": "or"
      },
      "founder.sex": {
        "list": [],
        "operator": "or"
      },
      "founder.organization": {
        "list": [],
        "operator": "or"
      },
      "amountOfFunds": {
        "list": [
          {
            "key": "Від 1 млрд. грн.",
            "from": 1000000000.001,
            "doc_count": 21
          }
        ]
      }
    },
    "sort": {},
    "searchIndex": "organization",
    "from": 0,
    "aggregation": false
  }

  {
    "total": 22,
    "items": [
      {
        "legalName": "АКЦІОНЕРНЕ ТОВАРИСТВО \"ЗАКРИТИЙ НЕДИВЕРСИФІКОВАНИЙ ВЕНЧУРНИЙ КОРПОРАТИВНИЙ ІНВЕСТИЦІЙНИЙ ФОНД \"ОРЕГОН\"",
        "head": {
          "fullName": "Карамаркова Юлія Юріївна"
        },
        "identifier": {
          "id": "40162043"
        },
        "amountOfFunds": 1000000000,
        "address": {
          "streetAddress": "вулиця Велика Житомирська, 6/11",
          "district": "Шевченківський район",
          "locality": "місто Київ",
          "region": "місто Київ",
          "apartment": "307"
        },
        "currentStatus": "зареєстровано",
        "name": "АТ \"ОРЕГОН\"",
        "founders": [
          {
            "person": {
              "fullName": "Шевченко Світлана"
            }
          }
        ],
        "full_kved": "64.30 Трасти, фонди та подібні фінансові суб'єкти"
      },
      {
        "legalName": "ТОВАРИСТВО З ОБМЕЖЕНОЮ ВІДПОВІДАЛЬНІСТЮ \"ІНТЕР-ТРЕЙД\"",
        "head": {
          "fullName": "Шатілова Ганна Валеріївна"
        },
        "identifier": {
          "id": "33072192"
        },
        "amountOfFunds": 18000000000,
        "address": {
          "streetAddress": "ВУЛ.ГЕНЕРАЛА ЦВЕТАЄВА, 3",
          "district": "Малиновський район",
          "locality": "місто Одеса",
          "region": "Одеська область",
          "apartment": "корпус 5"
        },
        "currentStatus": "зареєстровано",
        "name": "ТОВ \"ІНТЕР-ТРЕЙД\"",
        "founders": [
          {
            "person": {
              "fullName": "Шатілова Ганна Валеріївна"
            }
          },
          {
            "person": {
              "fullName": "Шепелєв Сергій Олександрович"
            }
          },
          {
            "person": {
              "fullName": "Червоненко Ігор Анатолійович"
            }
          },
          {
            "person": {
              "fullName": "Снєтков Володимир Костянтинович"
            }
          },
          {
            "person": {
              "fullName": "Музика Дар'я Ігорівна"
            }
          },
          {
            "person": {
              "fullName": "Галата Ігор Романович"
            }
          },
          {
            "person": {
              "fullName": "Алташин Олег Миколайович"
            }
          },
          {
            "person": {
              "fullName": "Чернов Віталій Валерійович"
            }
          },
          {
            "person": {
              "fullName": "Снєтков Віталій Володимирович"
            }
          },
          {
            "person": {
              "fullName": "Іванов Вячеслав Анатолійович"
            }
          }
        ],
        "full_kved": "51.70 Інші види оптової торгівлі"
      },
      {
        "legalName": "ТОВАРИСТВО З ОБМЕЖЕНОЮ ВІДПОВІДАЛЬНІСТЮ \"АВТОИНКОД\"",
        "head": {
          "fullName": "Карпіна Таісія Степанівна"
        },
        "identifier": {
          "id": "22450784"
        },
        "amountOfFunds": 1877680000,
        "address": {
          "streetAddress": "вулиця Троїцька, 24",
          "district": "Приморський район",
          "locality": "місто Одеса",
          "region": "Одеська область",
          "apartment": "13"
        },
        "currentStatus": "зареєстровано",
        "name": "ТОВ \"АВТОИНКОД\"",
        "founders": [
          {
            "person": {
              "fullName": "Карпіна Таісія Степанівна"
            }
          }
        ],
        "full_kved": "70.31.2 Посередницькі послуги під час купівлі, продажу, здавання в оренду та оцінювання нерухомості невиробничого призначення"
      },
      {
        "legalName": "ПРИВАТНЕ АКЦІОНЕРНЕ ТОВАРИСТВО \"F & С RЕАLТY\"",
        "head": {
          "fullName": "Ловейкіна Тетяна Олександрівна"
        },
        "identifier": {
          "id": "23496142"
        },
        "amountOfFunds": 1183273125,
        "address": {
          "streetAddress": "ВУЛ.КІКВІДЗЕ, 18-А",
          "district": "Печерський район",
          "locality": "місто Київ",
          "region": "місто Київ"
        },
        "currentStatus": "зареєстровано",
        "name": "ПРАТ \"F & С RЕАLТY\"",
        "full_kved": "68.20 Надання в оренду й експлуатацію власного чи орендованого нерухомого майна"
      },
      {
        "legalName": "ПУБЛІЧНЕ АКЦІОНЕРНЕ ТОВАРИСТВО \"ЗАКРИТИЙ НЕДИВЕРСИФІКОВАНИЙ ВЕНЧУРНИЙ КОРПОРАТИВНИЙ ІНВЕСТИЦІЙНИЙ ФОНД \"РЕНТАЛ\"",
        "head": {
          "fullName": "Голубашенко Маріана Вікторівна"
        },
        "identifier": {
          "id": "38013498"
        },
        "amountOfFunds": 1100000000,
        "address": {
          "streetAddress": "бульвар Лесі Українки, 7-Б",
          "district": "Печерський район",
          "locality": "місто Київ",
          "region": "місто Київ",
          "apartment": "157"
        },
        "currentStatus": "зареєстровано",
        "name": "ПАТ \"ЗНВКІФ \"РЕНТАЛ\"",
        "full_kved": "64.30 Трасти, фонди та подібні фінансові суб'єкти"
      },
      {
        "legalName": "АКЦІОНЕРНЕ ТОВАРИСТВО \"ЗАКРИТИЙ НЕДИВЕРСИФІКОВАНИЙ ВЕНЧУРНИЙ КОРПОРАТИВНИЙ ІНВЕСТИЦІЙНИЙ ФОНД \"ТРЕНД-КАПІТАЛ\"",
        "head": {
          "fullName": "Покінська Наталія Петрівна"
        },
        "identifier": {
          "id": "41150877"
        },
        "amountOfFunds": 2400000000,
        "address": {
          "streetAddress": "вулиця Фізкультури, 28Д",
          "district": "Голосіївський район",
          "locality": "місто Київ",
          "region": "місто Київ"
        },
        "currentStatus": "зареєстровано",
        "name": "АТ \"ЗНВКІФ \"ТРЕНД-КАПІТАЛ\"",
        "full_kved": "64.30 Трасти, фонди та подібні фінансові суб'єкти"
      },
      {
        "legalName": "ТОВАРИСТВО З ОБМЕЖЕНОЮ ВІДПОВІДАЛЬНІСТЮ \"АЛКИД-ТОРГ\"",
        "head": {
          "fullName": "Черновол Людмила Євгенівна"
        },
        "identifier": {
          "id": "37296197"
        },
        "amountOfFunds": 1000002000,
        "address": {
          "streetAddress": "вулиця Цусимська, 52",
          "district": "Калінінський район",
          "locality": "місто Донецьк",
          "region": "Донецька область"
        },
        "currentStatus": "зареєстровано",
        "name": "ТОВ \"АЛКИД-ТОРГ\"",
        "full_kved": "46.90 Неспеціалізована оптова торгівля"
      },
      {
        "legalName": "ТОВАРИСТВО З ОБМЕЖЕНОЮ ВІДПОВІДАЛЬНІСТЮ \"МОНСАНТО ХОЛДИНГ УКРАЇНА\"",
        "head": {
          "fullName": "Озерова Лідія Володимирівна"
        },
        "identifier": {
          "id": "38260782"
        },
        "amountOfFunds": 4000000000,
        "address": {
          "streetAddress": "вулиця Володимирська, 101А",
          "district": "Голосіївський район",
          "locality": "місто Київ",
          "region": "місто Київ"
        },
        "currentStatus": "зареєстровано",
        "name": "ТОВ \"МОНСАНТО ХОЛДИНГ УКРАЇНА\"",
        "founders": [
          {
            "organization": {
              "source": "КОМПАНІЯ МОНСАНТО ГОЛЛАНДІЯ Б.В."
            }
          },
          {
            "organization": {
              "source": "КОМПАНІЯ МОНСАНТО ІНВЕСТ Б.В."
            }
          }
        ],
        "full_kved": "70.10 Діяльність головних управлінь (хед-офісів)"
      },
      {
        "legalName": "ТОВАРИСТВО З ОБМЕЖЕНОЮ ВІДПОВІДАЛЬНІСТЮ \"ГАЛЕРЕЯ Ф.К.А.У.\"",
        "head": {
          "fullName": "Корягіна Ганна Сергіївна"
        },
        "identifier": {
          "id": "35085093"
        },
        "amountOfFunds": 1375108444.61,
        "address": {
          "streetAddress": "проспект Степана Бандери, 15-А",
          "district": "Оболонський район",
          "locality": "місто Київ",
          "region": "місто Київ"
        },
        "currentStatus": "зареєстровано",
        "name": "ТОВ \"ГАЛЕРЕЯ Ф.К.А.У.\"",
        "full_kved": "68.20 Надання в оренду й експлуатацію власного чи орендованого нерухомого майна"
      },
      {
        "legalName": "ПУБЛІЧНЕ АКЦІОНЕРНЕ ТОВАРИСТВО \"АЛЬФА-БАНК\"",
        "head": {
          "fullName": "Михайльо Вікторія Вікторівна"
        },
        "identifier": {
          "id": "23494714"
        },
        "amountOfFunds": 12179756466,
        "address": {
          "streetAddress": "вулиця Десятинна, 4/6",
          "district": "Шевченківський район",
          "locality": "місто Київ",
          "region": "місто Київ"
        },
        "currentStatus": "зареєстровано",
        "name": "ПАТ \"АЛЬФА-БАНК\"",
        "full_kved": "64.19 Інші види грошового посередництва"
      }
    ]
  }